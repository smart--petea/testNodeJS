var sessions = {};
var sessionRegExp = /sessionId=(\d+)/;

/* exports */
module.exports.create = createSession;
module.exports.close = closeSession;
module.exports.isOpen = isOpen;

/* functions */
function createSession() {
	var sessionToken = new Date().getTime().toString();	
	sessions[sessionToken] = {};
	return sessionToken;
}

function isOpen(req, res) {
	var cookie = req.headers.cookie || "";
	var matches = cookie.match(sessionRegExp);

	return matches && matches.length > 1 && (matches[1] in sessions);
}

function closeSession(req, res) {
	isOpen(sessionToken) && (delete sessions(sessionToken));
}
